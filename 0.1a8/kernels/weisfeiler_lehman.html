

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Weisfeiler Lehman Framework &mdash; GraKeL 0.1.8 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/_static/css/supplementary.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Weisfeiler-Lehman Optimal Assignment" href="weisfeiler_lehman_optimal_assignment.html" />
    <link rel="prev" title="Vertex Histogram Kernel" href="vertex_histogram.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GraKeL
          

          
            
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">GraKeL</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../kernels.html">Kernels (between graphs)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="core_framework.html">Core Kernel Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="edge_histogram.html">Edge Histogram Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph_hopper.html">Graph Hopper Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="graphlet_sampling.html">Graphlet Sampling Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="hadamard_code.html">Hadamard Code Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="kernel.html">Kernel (general class)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lovasz_theta.html">Lovasz Theta Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiscale_laplacian.html">Multiscale Laplacian Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="neighborhood_hash.html">Neighborhood Hash Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="neighborhood_subgraph_pairwise_distance.html">Neighborhood Subgraph Pairwise Distance Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="odd_sth.html">ODD-STh Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="propagation.html">Propagation Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyramid_match.html">Pyramid Match Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="random_walk.html">Random Walk Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="shortest_path.html">Shortest Path Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="subgraph_matching.html">Subgraph Matching Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="svm_theta.html">SVM Theta Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="vertex_histogram.html">Vertex Histogram Kernel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Weisfeiler Lehman Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#definition-weisfeiler-lehman-framework">Definition: Weisfeiler-Lehman Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="#weisfeiler-lehman-subtree-kernel">Weisfeiler-Lehman Subtree Kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="weisfeiler_lehman_optimal_assignment.html">Weisfeiler-Lehman Optimal Assignment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graph_kernel.html">GraphKernel (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph.html">Graph (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets.html">Dataset loading utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GraKeL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api.html">GraKeL</a> &raquo;</li>
        
          <li><a href="../kernels.html">Kernels (between graphs)</a> &raquo;</li>
        
      <li>Weisfeiler Lehman Framework</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/kernels/weisfeiler_lehman.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="weisfeiler-lehman-framework">
<span id="weisfeiler-lehman"></span><h1>Weisfeiler Lehman Framework<a class="headerlink" href="#weisfeiler-lehman-framework" title="Permalink to this headline">Â¶</a></h1>
<p>This Weisfeiler Lehman framework operates on top of existing graph kernels and is inspired by the
Weisfeiler-Lehman test of graph isomorphism <a class="bibtex reference internal" href="#weisfeiler1968reduction" id="id1">[WL68]</a>.
The key idea of the Weisfeiler-Lehman algorithm is to replace the label of each vertex with a multiset
label consisting of the original label of the vertex and the sorted set of labels of its neighbors.
The resultant multiset is then compressed into a new, short label.
This relabeling procedure is then repeated for <span class="math notranslate nohighlight">\(h\)</span> iterations.
Note that this procedure is performed simultaneously on all input graphs.
Therefore, two vertices from different graphs will get identical new labels
if and only if they have identical multiset labels.</p>
<p>More formally, given a graph <span class="math notranslate nohighlight">\(G=(V,E)\)</span> endowed with a labeling function <span class="math notranslate nohighlight">\(\ell=\ell_0\)</span>,
the Weisfeiler-Lehman graph of <span class="math notranslate nohighlight">\(G\)</span> at height <span class="math notranslate nohighlight">\(i\)</span> is a graph <span class="math notranslate nohighlight">\(G_i=(V,E)\)</span> endowed
with a labeling function <span class="math notranslate nohighlight">\(\ell_i\)</span> which has emerged after <span class="math notranslate nohighlight">\(i\)</span> iterations of the
relabeling procedure described above.</p>
<p>The Weisfeiler-Lehman sequence up to height <span class="math notranslate nohighlight">\(h\)</span> of <span class="math notranslate nohighlight">\(G\)</span> consists of the Weisfeiler-Lehman
graphs of <span class="math notranslate nohighlight">\(G\)</span> at heights from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(\{ G_0,G_1,\ldots,G_h\}\)</span>.</p>
<div class="section" id="definition-weisfeiler-lehman-framework">
<h2>Definition: Weisfeiler-Lehman Framework<a class="headerlink" href="#definition-weisfeiler-lehman-framework" title="Permalink to this headline">Â¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(k\)</span> be any kernel for graphs, that we will call the base kernel.
Then the Weisfeiler-Lehman kernel with <span class="math notranslate nohighlight">\(h\)</span> iterations with the base
kernel <span class="math notranslate nohighlight">\(k\)</span> between two graphs <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(G'\)</span> is defined as</p>
<div class="math notranslate nohighlight">
    \begin{equation}
            k_{WL}(G,G') = k(G_0,G_0') + k(G_1,G_1') + \ldots + k(G_h,G_h')
    \end{equation}</div><p>where <span class="math notranslate nohighlight">\(h\)</span> is the number of Weisfeiler-Lehman iterations, and
<span class="math notranslate nohighlight">\(\{ G_0,G_1,\ldots,G_h\}\)</span> and <span class="math notranslate nohighlight">\(\{ G_0',G_1',\ldots,G_h'\}\)</span>
are the Weisfeiler-Lehman sequences of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(G'\)</span> respectively.</p>
<p>From the above definition, it is clear that any graph kernel that takes into
account discrete node labels can take advantage of the Weisfeiler-Lehman framework
and compare graphs based on the whole Weisfeiler-Lehman sequence.</p>
<p>The general implementation of this framework can be found here:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../generated/grakel.WeisfeilerLehman.html#grakel.WeisfeilerLehman" title="grakel.WeisfeilerLehman"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WeisfeilerLehman</span></code></a>([n_jobs,Â verbose,Â â¦])</p></td>
<td><p>Compute the Weisfeiler Lehman Kernel.</p></td>
</tr>
</tbody>
</table>
<p>It should support all <code class="code docutils literal notranslate"><span class="pre">Kernel</span></code> objects inside its parameter <code class="code docutils literal notranslate"><span class="pre">base_kernel</span></code> (formulated in the correct way).</p>
</div>
<div class="section" id="weisfeiler-lehman-subtree-kernel">
<h2>Weisfeiler-Lehman Subtree Kernel<a class="headerlink" href="#weisfeiler-lehman-subtree-kernel" title="Permalink to this headline">Â¶</a></h2>
<p>The Weisfeiler-Lehman subtree kernel is a very popular algorithm, and is considered the state-of-the-art in graph classification.
Let <span class="math notranslate nohighlight">\(G\)</span>, <span class="math notranslate nohighlight">\(G'\)</span> be two graphs. Define <span class="math notranslate nohighlight">\(\Sigma_i \subseteq \Sigma\)</span> as the set of letters that occur as node labels
at least once in <span class="math notranslate nohighlight">\(G\)</span> or <span class="math notranslate nohighlight">\(G'\)</span> at the end of the <span class="math notranslate nohighlight">\(i^{th}\)</span> iteration of the Weisfeiler-Lehman algorithm.
Let <span class="math notranslate nohighlight">\(\Sigma_0\)</span> be the set of original node labels of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(G'\)</span>.
Assume all <span class="math notranslate nohighlight">\(\Sigma_i\)</span> are pairwise disjoint.
Without loss of generality, assume that every <span class="math notranslate nohighlight">\(\Sigma_i = \{ \sigma_{i1},\ldots,\sigma_{i|\Sigma_i|} \}\)</span> is ordered.
Define a map <span class="math notranslate nohighlight">\(c_i : \{ G,G' \} \times \Sigma_i \rightarrow \mathbb{N}\)</span> such that <span class="math notranslate nohighlight">\(c_i(G, \sigma_{ij})\)</span>
is the number of occurrences of the letter <span class="math notranslate nohighlight">\(\sigma_{ij}\)</span> in the graph <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>The Weisfeiler-Lehman subtree kernel on two graphs <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(G'\)</span> with <span class="math notranslate nohighlight">\(h\)</span> iterations is defined as</p>
<div class="math notranslate nohighlight">
\begin{equation}
        k(G,G') = \langle \phi(G),\phi(G') \rangle
\end{equation}</div><p>where</p>
<div class="math notranslate nohighlight">
\begin{equation}
        \phi(G) = (c_0(G,\sigma_{01}),\ldots,c_0(G,\sigma_{0|\Sigma_0|}),\ldots,c_h(G,\sigma_{h1}),\ldots,c_h(G,\sigma_{h|\Sigma_h|}))
\end{equation}</div><p>and</p>
<div class="math notranslate nohighlight">
\begin{equation}
        \phi(G') = (c_0(G',\sigma_{01}),\ldots,c_0(G',\sigma_{0|\Sigma_0|}),\ldots,c_h(G',\sigma_{h1}),\ldots,c_h(G',\sigma_{h|\Sigma_h|}))
\end{equation}</div><p>It can be shown that the above definition is equivalent to comparing the number of shared subtrees between the two input graphs <a class="bibtex reference internal" href="#shervashidze2011weisfeiler" id="id2">[SSVL+11]</a>.
It is interesting to note that the Weisfeiler-Lehman subtree kernel exhibits an attractive computational complexity since it can be computed in <span class="math notranslate nohighlight">\(\mathcal{O}(hm)\)</span> time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To create an instance of the above kernel use the <a class="reference internal" href="vertex_histogram.html#vertex-histogram"><span class="std std-ref">Vertex Histogram Kernel</span></a> as the <code class="code docutils literal notranslate"><span class="pre">base_kernel</span></code>.</p>
</div>
</div>
<div class="section" id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">Â¶</a></h2>
<p id="bibtex-bibliography-kernels/weisfeiler_lehman-0"><dl class="citation">
<dt class="bibtex label" id="shervashidze2011weisfeiler"><span class="brackets"><a class="fn-backref" href="#id2">SSVL+11</a></span></dt>
<dd><p>Nino Shervashidze, Pascal Schweitzer, Erik JanÂ van VanÂ Leeuwen, Kurt Mehlhorn, and KarstenÂ M. Borgwardt. Weisfeiler-Lehman Graph Kernels. <em>Journal of Machine Learning Research</em>, 12:2539â2561, 2011.</p>
</dd>
<dt class="bibtex label" id="weisfeiler1968reduction"><span class="brackets"><a class="fn-backref" href="#id1">WL68</a></span></dt>
<dd><p>Boris Weisfeiler and AAÂ Lehman. A reduction of a graph to a canonical form and an algebra arising during this reduction. <em>Nauchno-Technicheskaya Informatsia</em>, 2(9):12â16, 1968.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="weisfeiler_lehman_optimal_assignment.html" class="btn btn-neutral float-right" title="Weisfeiler-Lehman Optimal Assignment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="vertex_histogram.html" class="btn btn-neutral float-left" title="Vertex Histogram Kernel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, DaSciM (BSD License).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>